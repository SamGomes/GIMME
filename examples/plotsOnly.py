import matplotlib.pyplot as plt
import numpy as np 
import seaborn as sns
import matplotlib.collections as collections

maxNumTrainingIterations = 20
numRealIterations = 20

GIMMEAbilityMeans = [0.2765131428393123, 0.3349983644638688, 0.3479249751476072, 0.35182431077428306, 0.35349570395458546, 0.3553244213956623, 0.3567776181671621, 0.35904089411250034, 0.3614620281898095, 0.3642869536299546, 0.3649583033228906, 0.3666078880234048, 0.36673912642333145, 0.36674816098377855, 0.3661681453104005, 0.3666390147582722, 0.3661951559430958, 0.36618592308953957, 0.3666848586816986, 0.36657255191439636, 0.30620653697036526, 0.3686668169095683, 0.3829529115267108, 0.38551633964713006, 0.38675295754435723, 0.38800813930398714, 0.3889546146326473, 0.38974251821312916, 0.3910517530554963, 0.3915914049809997, 0.39271894489711245, 0.39410055614791906, 0.3949883561451445, 0.39455451172477923, 0.39453972016412786, 0.3949440637973427, 0.39443172814128497, 0.39457167499964485, 0.394725828275346, 0.3945626537276801]
GIMMEAbilitySTDev = [0.022845165142706205, 0.026418274946513137, 0.02688523717494193, 0.027217996465092466, 0.027194446356054773, 0.027180100575800538, 0.026989425276035182, 0.0270206785793126, 0.027402410832322015, 0.026409502814581962, 0.02639206467388524, 0.026595268714380154, 0.02703255323131049, 0.027009880333834252, 0.027117093359699217, 0.027124267797679742, 0.0267927644310371, 0.027021020247076772, 0.026558963550220145, 0.02644373886556713, 0.023566924386861244, 0.02748862331162324, 0.028346409919032513, 0.028778550916652716, 0.028733405579392423, 0.028542044140809898, 0.028553172765076056, 0.028646979263029483, 0.028335074006537023, 0.02837404937068773, 0.02803715271128719, 0.028297946520927444, 0.02857295239239772, 0.028454320365107068, 0.028416860001647403, 0.028248771954651294, 0.02830174536784205, 0.02802345447103691, 0.028490504108846498, 0.028811891531670582]
GIMMEEngagementMeans = [0.5505488754362852, 0.6675874721397262, 0.6930618322865831, 0.7004612546185881, 0.7042456030525555, 0.7072569692058673, 0.7100065606293482, 0.7142192558633125, 0.7190550090162563, 0.7249471509582123, 0.726070745530259, 0.7291306709806993, 0.7294823734145193, 0.7294540017633602, 0.728527214127732, 0.7291629420191255, 0.7283844763758047, 0.728345119211797, 0.7293294677985845, 0.7291633023097218, 0.6099233469157528, 0.7343141472916616, 0.762911631411665, 0.7679980586552714, 0.7703376842919016, 0.7729508140122114, 0.7747116268879577, 0.7762388437967007, 0.7788886445885528, 0.7798462091391363, 0.7818475053298823, 0.7844620499583925, 0.7864517149938942, 0.7853528347137635, 0.785476797080941, 0.7860474035964214, 0.7852081111106705, 0.7854553390442375, 0.7854771876715084, 0.7853068012549062]
GIMMEEngagementSTDev = [0.026129766481501084, 0.026416876472891124, 0.02682551649873178, 0.026296960224113937, 0.026313997365251616, 0.026076324362281703, 0.025049920673123408, 0.024892461558331976, 0.02435794330561604, 0.021672759012000525, 0.021731036289373395, 0.02284487045169842, 0.022455950649942776, 0.02146101176590148, 0.021141313056569907, 0.022704179719921207, 0.022651860631453333, 0.022004825382946843, 0.021558435835489668, 0.020803878930088095, 0.021543212009903397, 0.022611129337258562, 0.022767870285113474, 0.022147044001610244, 0.022240968272289597, 0.020726570328906704, 0.020604107101479953, 0.02190190958018047, 0.020893728445558712, 0.020184169674016206, 0.019720036239832858, 0.01941245120359494, 0.019200444106278764, 0.019288536291033307, 0.0194443998331246, 0.019339966657041387, 0.02002378578458773, 0.019772265986643257, 0.01972718491146058, 0.019971707785797415]
GIMMEProfDiffMeans = [0.44097145438403346, 0.4287229125079422, 0.42506957318714683, 0.4209956653207022, 0.4169219100745389, 0.4129364857254447, 0.409140527586679, 0.40266559153967457, 0.3956065196067021, 0.38690028272281757, 0.38699721613126176, 0.3819852317120303, 0.38244535079020947, 0.3826198508454875, 0.38424816450670457, 0.3827966768382836, 0.3843975864280612, 0.38419193155430276, 0.3824379177936032, 0.38307967943392085, 0.33601122585278725, 0.3317577469992786, 0.3251828488654707, 0.3263019683486213, 0.32396437906385467, 0.3201721572770268, 0.3179833313376008, 0.315906109118733, 0.31176183156320975, 0.3110059266497131, 0.3078066515741884, 0.30389231103666714, 0.30129942805770527, 0.30394544512163063, 0.30333779569662783, 0.3023729236706354, 0.3040583370590607, 0.30332456098421495, 0.303373345977121, 0.3036822741098742]
GIMMEProfDiffSTDev = [0.04619133767474833, 0.04343937297383331, 0.04344428939510895, 0.0417850363931894, 0.04180851739788507, 0.040909318100267114, 0.039368507316263394, 0.038872029163192205, 0.03809698719475294, 0.03341421910571498, 0.034060384719793994, 0.03573386832858742, 0.03468223481060844, 0.03303726381721949, 0.032894498981969465, 0.03571113427877534, 0.03518448101461541, 0.03427990040593816, 0.033638214308701626, 0.03231854534800781, 0.03808337825192398, 0.03858309144213156, 0.038106135858447666, 0.03628582760473297, 0.03680929580048769, 0.03402039987297559, 0.033862482964380686, 0.03616440726664596, 0.03393934308606357, 0.03278638404680238, 0.03208624237823406, 0.03166063973577564, 0.030865361030193335, 0.03126494672516624, 0.03156814608333309, 0.03137207684984106, 0.03247270778051739, 0.03200134410056021, 0.03188057152917348, 0.03236927731939694]

GIMMEOldAbilityMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2964245951594018, 0.36034524652924693, 0.37550240762885406, 0.3792588165127019, 0.38097854379206986, 0.38263805790168687, 0.3842254424635376, 0.38601642252726176, 0.3877913767348507, 0.3899161021504646, 0.3910658744036323, 0.3920325450530177, 0.39270221164791913, 0.3918856578138446, 0.392520257016696, 0.3921196245257521, 0.3921706857316381, 0.3919541378086497, 0.39198420888268914, 0.3923289851669565]
GIMMEOldAbilitySTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.024002895089537145, 0.027670099604243707, 0.028349625567688483, 0.02911802753670903, 0.02869291986700275, 0.02866267384950044, 0.02938782224447491, 0.028444672527462307, 0.0287189283913537, 0.028796438522280185, 0.028635408092074714, 0.02855372182407172, 0.028939277353370433, 0.028689921344531192, 0.028891898616520043, 0.028580334082819948, 0.028712207828381412, 0.02843289820997117, 0.028696711387090432, 0.028380534164777458]
GIMMEOldEngagementMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5939109959768548, 0.7216083914860262, 0.7518469292589882, 0.7591676281002178, 0.7625757702115941, 0.7658891648047113, 0.7688343489000521, 0.772209595055208, 0.7759421210061074, 0.7801407432707566, 0.7823419854942506, 0.7841933586343627, 0.7855829640656938, 0.7841643115267478, 0.7852663932732393, 0.7845388141848576, 0.784546586795803, 0.7843299502461901, 0.7844155293617299, 0.7850133748963819]
GIMMEOldEngagementSTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.024113376067434383, 0.023315575572684384, 0.02362489551450893, 0.02375898708183264, 0.02306919573098927, 0.021783183854376373, 0.021776696994802395, 0.020674262238372935, 0.020551542536610096, 0.019517022985851222, 0.01931503487004056, 0.019411982447417084, 0.01888583363789175, 0.01929550900659117, 0.019751259718815917, 0.0193471275160774, 0.018871802576980706, 0.019011623714559216, 0.01880521898347184, 0.019033947030687507]
GIMMEOldProfDiffMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3643173306818696, 0.34855734125912347, 0.3402505006302566, 0.3380001487023245, 0.33456360560364956, 0.3299112563389008, 0.3258763191175232, 0.3209509503291405, 0.3155460440242948, 0.30944350554227606, 0.30703665942159614, 0.30454211981853263, 0.30274018051030277, 0.3057393272982249, 0.3032895341920935, 0.30496536919838435, 0.30469439097999823, 0.3050801019461609, 0.30485222542720286, 0.3038256306345288]
GIMMEOldProfDiffSTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0426268293364705, 0.040399035079046464, 0.03939065815711208, 0.03900287124589066, 0.03804131607780555, 0.03576819658142031, 0.03581846602238256, 0.03397411718447627, 0.0334442294990366, 0.031501704667286766, 0.03126566330923527, 0.03159966422441122, 0.030400520431584824, 0.03182511052824367, 0.03218741407868292, 0.03173783342384852, 0.030846656355625716, 0.031004701779213887, 0.030717853396353263, 0.03117760691785381]

optimalAbilityMeans = [0.305237923996252, 0.3663378769910496, 0.37856412854305216, 0.38101942599910205, 0.3813614640510011, 0.38165126126110493, 0.3816718415962283, 0.38158137483969296, 0.38161636989981773, 0.38157219547973353, 0.3817188223578568, 0.3815587315951851, 0.38162432790038764, 0.381505763854315, 0.3816815914867459, 0.38155482741449254, 0.38157877596540707, 0.3816104593856616, 0.38156251889958537, 0.3815201826380777, 0.3230581111904185, 0.38771039107857624, 0.4006483384147573, 0.4032039485372953, 0.40370958006938606, 0.4037968344262043, 0.4038104442603684, 0.40383762807006035, 0.4038147108073856, 0.4038911655883242, 0.4039009881686114, 0.4038916866551046, 0.403889744348699, 0.4039377557880597, 0.40386300965134386, 0.40382339764737135, 0.4039512154508011, 0.40396053201533255, 0.4038963408302469, 0.40386286218515316]
optimalAbilitySTDev = [0.021821256277654754, 0.02617063894690486, 0.027068446644073655, 0.027174142516427864, 0.027251308808099974, 0.027282211801459625, 0.027354240498265993, 0.027250521331201268, 0.02726823512129633, 0.02729341088775373, 0.027175191651199963, 0.02726632197062172, 0.0273777250138019, 0.027319510496642222, 0.02732067075456944, 0.027211856941982082, 0.027363180554429586, 0.02725307551483863, 0.02726965218772209, 0.0273009605305761, 0.0228991003063653, 0.027491046330772092, 0.02832179924679931, 0.028518210250485003, 0.028550091249656313, 0.028594383765542977, 0.028635400924647135, 0.02863696361955982, 0.028565599074175406, 0.028623009357410422, 0.028692213418583246, 0.028551423691010727, 0.028635772066109174, 0.028612548010801854, 0.028589970552282157, 0.028571769293024747, 0.02863837891223729, 0.02865907212904289, 0.028584542430102517, 0.028633026239624684]
optimalEngagementMeans = [0.6084064491951118, 0.7301695751503942, 0.754604248816523, 0.759402736414272, 0.7601138203895994, 0.7607443250295116, 0.760799080124412, 0.7605428633849177, 0.7606568322276098, 0.7605354869985838, 0.7608129473676792, 0.760441432715893, 0.7605177296027819, 0.7603119834882102, 0.7607035439360946, 0.7604389458155824, 0.7604948130732162, 0.7606070877529908, 0.7605730491299884, 0.7604617809729827, 0.644310019064983, 0.7732459339416189, 0.7990507063808413, 0.8041603475175025, 0.8050624466044178, 0.8053236078110934, 0.805364503680413, 0.8054297012616842, 0.8053878110509168, 0.8055475311655018, 0.805541390264152, 0.8055018318898273, 0.8055481365929678, 0.8055713847458102, 0.8055373020393013, 0.8053839608739078, 0.8056363862125384, 0.8056850649865265, 0.8056025465280785, 0.8054395829022891]
optimalEngagementSTDev = [0.012121694363635515, 0.01441908365220553, 0.014658245109022387, 0.015004953872474395, 0.014953868471806565, 0.014822702415249672, 0.014654565344936296, 0.014791149182414698, 0.014483595968507639, 0.014539338623534692, 0.014592967734223243, 0.01473225564349862, 0.014767679894054251, 0.014852356978754791, 0.01459013950985977, 0.014555300804257678, 0.014866329457247704, 0.014880934053716554, 0.014713003046383387, 0.014495845890153082, 0.00810715395173732, 0.009523298843264371, 0.009744168353274438, 0.009894059409460958, 0.009890637759615128, 0.009924726404931665, 0.009933186511199635, 0.009851190429960478, 0.00974833994436543, 0.00999354989494586, 0.010008686367557605, 0.00988765308161339, 0.009898111834278746, 0.009732442506738194, 0.009841606105293539, 0.009905464451404769, 0.00982737293110461, 0.010011917733177174, 0.00992451676009325, 0.009913142738874298]
optimalProfDiffMeans = [0.33869274751436507, 0.3385480803324811, 0.33840303774970837, 0.3385593916728864, 0.3389988824804234, 0.33813570336476995, 0.33826182617072265, 0.33873411650505103, 0.3384420598542968, 0.3386968640108252, 0.33816347672242597, 0.33891832510064607, 0.33865209972059696, 0.33904278592569104, 0.3382778560694226, 0.3388840414066509, 0.33869173155220444, 0.3385130081419997, 0.33861287558858266, 0.3387975372888789, 0.27522360320488687, 0.2750929456691266, 0.2750618515961342, 0.2751525616425997, 0.2753643916370331, 0.2752216596773041, 0.2752416997411177, 0.27514090448479606, 0.27523800744095706, 0.2749408490746211, 0.27500817434514796, 0.2750759331954967, 0.27498009127415024, 0.2749553651426324, 0.27502383488813015, 0.27528285627639554, 0.2747824128157289, 0.2747856059221047, 0.2749486898715568, 0.27520759690299124]
optimalProfDiffSTDev = [0.02142833071005515, 0.021607679104937345, 0.021250514869285943, 0.021785655536870244, 0.021565195634398886, 0.021344931805736787, 0.021135635423839397, 0.02140187438860329, 0.020827483299103635, 0.02100013583716143, 0.021092163943783382, 0.02127989418424161, 0.021307440063476266, 0.021461034999802998, 0.020995623340162344, 0.02099340964585358, 0.02157397314381691, 0.021481529777366205, 0.02116028166453471, 0.020858244176695774, 0.014331558838479577, 0.01421648812451849, 0.014115022561319739, 0.01430222417730386, 0.014257993227137751, 0.014301795024651875, 0.014283577828554463, 0.014164840984503999, 0.014013430279910345, 0.014483965288257008, 0.014430107325862031, 0.014207134487934769, 0.014245456400158476, 0.01396309369059382, 0.014195215423755606, 0.014288070604505904, 0.014149820755466388, 0.014502689598752722, 0.014283500767887647, 0.014273854586258076]

randomAbilityMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2961690350621428, 0.35578707374124857, 0.3671273388233011, 0.36884965603690717, 0.36917069777631256, 0.36935476457436933, 0.3695406381271837, 0.3700609220204443, 0.3708736775245795, 0.3698695074885426, 0.36998028141532807, 0.369532260702455, 0.3704124931130309, 0.36977710627130556, 0.36986137832593713, 0.3702477837344821, 0.369988157583982, 0.37017453144398266, 0.3694138041398453, 0.36976581847549617]
randomAbilitySTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.022642425607831543, 0.02651770219660834, 0.027137648430172235, 0.027487984339818, 0.027565469414526672, 0.02757873510773281, 0.026574968118114693, 0.02797329827316299, 0.027733822135553168, 0.027157899222035715, 0.027694038213742264, 0.028051495040748237, 0.026876492258201354, 0.027589079071312025, 0.02729962938780666, 0.027443948596831313, 0.027624399003726388, 0.02692264215609173, 0.027344562854598627, 0.02785045808316688]
randomEngagementMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.595005745711558, 0.7146917498470532, 0.7371280157712524, 0.7405949584783552, 0.7415335936817138, 0.7420481519491587, 0.7423348086450159, 0.7429781819724933, 0.7446444781498284, 0.7429220038540183, 0.7431868789578501, 0.7423545514894331, 0.744123665482392, 0.7428214318270124, 0.7430531018934748, 0.7436131935680547, 0.7430997084945498, 0.7435920424487222, 0.7419956190727285, 0.7426190933630774]
randomEngagementSTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.023331051679267686, 0.024422664473443507, 0.024705507720659988, 0.02541172444786132, 0.024813608931763795, 0.02531260743642402, 0.024120219528411868, 0.02575894768669138, 0.02406759841521661, 0.02491705348443353, 0.024710523696680437, 0.025160981424906057, 0.024210881337063245, 0.024979559992020204, 0.02476465249108867, 0.02384323712483639, 0.02527523866247757, 0.024064066310191513, 0.024450333383919668, 0.024916031064117623]
randomProfDiffMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3623820682790916, 0.36117140425456645, 0.36382470737446826, 0.365628378518776, 0.3651948395744762, 0.36461707813259137, 0.36429225971892, 0.363256274058941, 0.3605381175641434, 0.36417217536483976, 0.3630949512821283, 0.3646599597658851, 0.36123830631455983, 0.3641658281861357, 0.3632958803744497, 0.36238767655899223, 0.3634934208133668, 0.36244154473060225, 0.36543771555642623, 0.36377113741251993]
randomProfDiffSTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0412438621365227, 0.04131429862394724, 0.0418120592737466, 0.042811439766259354, 0.04131784518777736, 0.0422392169308507, 0.04040884089215447, 0.04308310716287283, 0.04060763891363281, 0.04214441206962135, 0.04164976611331936, 0.04191994477088203, 0.040482141655122844, 0.04160930153847041, 0.04122433712970558, 0.039747210173190266, 0.0421088203826271, 0.04040437411775887, 0.041589088794133505, 0.04164333239232043]


# ----------------------- [Generate Plots] --------------------------------
# sns.set()
sns.set_palette(sns.color_palette("colorblind"))

timesteps=[i+1 for i in range(maxNumTrainingIterations + numRealIterations)]
timestepsReal=[i+1 for i in range(numRealIterations)]
convValue=[1.0 for i in range(maxNumTrainingIterations + numRealIterations)]
empHighestValue=[max(optimalAbilityMeans) for i in range(maxNumTrainingIterations + numRealIterations)]
totalMin = min(min(randomAbilityMeans[maxNumTrainingIterations:]),min(GIMMEAbilityMeans),min(GIMMEOldAbilityMeans[maxNumTrainingIterations:]),min(optimalAbilityMeans[maxNumTrainingIterations:]))
totalMax = max(max(randomAbilityMeans[maxNumTrainingIterations:]),max(GIMMEAbilityMeans),max(GIMMEOldAbilityMeans[maxNumTrainingIterations:]),max(optimalAbilityMeans[maxNumTrainingIterations:]))

plt.rcParams.update({'font.size': 22})

fig = plt.figure(num=None, figsize=(20, 10), dpi=100, facecolor='w', edgecolor='k')
ax = fig.add_subplot(111)
c1 = collections.BrokenBarHCollection([(0,maxNumTrainingIterations)], (totalMin,(totalMax-totalMin)), facecolor="white", alpha=0.5)
# c2 = collections.BrokenBarHCollection([(maxNumTrainingIterations,numRealIterations)], (totalMin-0.05,(totalMax-totalMin)+0.1), facecolor='#bdedcf', alpha=0.5)
ax.add_collection(c1)
# ax.add_collection(c2)
plt.xticks(np.arange(1, numRealIterations+1, step=1.0), fontsize=30)
plt.yticks(fontsize=30)


plt.errorbar(timestepsReal, GIMMEAbilityMeans[maxNumTrainingIterations:], GIMMEAbilitySTDev[maxNumTrainingIterations:], marker='s', capsize=5.0, alpha=0.5, linewidth=3, elinewidth=2, label="GIMME strategy (informed)")
plt.errorbar(timestepsReal, GIMMEOldAbilityMeans[maxNumTrainingIterations:], GIMMEOldAbilitySTDev[maxNumTrainingIterations:], marker='s', capsize=5.0, alpha=0.5, linewidth=3, elinewidth=2, label="GIMME strategy (uninformed)")
# plt.errorbar(timesteps, GIMMEGridAbilityMean, GIMMEGridAbilitySTDev, marker='s', capsize=2.0, alpha=0.5, label="GIMME Grid strategy")
# plt.plot(timesteps, GIMMEEvAbilities, label="GIMME Ev strategy")
plt.errorbar(timestepsReal, randomAbilityMeans[maxNumTrainingIterations:], randomAbilitySTDev[maxNumTrainingIterations:], marker='s', capsize=5.0, alpha=0.5, linewidth=3, elinewidth=2, label="Random strategy")
# plt.errorbar(timesteps, optimalAbilityMeans, optimalAbilitySTDev, marker='s', capsize=2.0, alpha=0.5, label="\"Perfect Information\" strategy")
plt.plot(timestepsReal, empHighestValue[maxNumTrainingIterations:], linestyle= "--", linewidth=3, label="\"Perfect Information\" upper bound")
plt.xlabel("Iteration", fontsize=40)
plt.ylabel("avg. Ability Increase", fontsize=40)
plt.legend(loc='best', fontsize=29)

plt.savefig('./plotsOnlyOutput/simulationsResultsAbility.png')
plt.show()
