import matplotlib.pyplot as plt
import numpy as np 
import seaborn as sns
import matplotlib.collections as collections

maxNumTrainingIterations = 20
numRealIterations = 20

GIMMEAbilityMeans = [0.27689083128973474, 0.3351225543691162, 0.34849331661175803, 0.35303323256357355, 0.35528803276718185, 0.3572431887493089, 0.35762593038095036, 0.3600842523051019, 0.3625312019518175, 0.365441201414142, 0.36647377059004976, 0.36690977744324615, 0.36732558545598787, 0.36655936929994837, 0.36803474994417024, 0.3673347617631217, 0.3675962166720442, 0.3671758587404084, 0.36723204552101335, 0.3675006551071768, 0.30746158177379207, 0.36989514884803165, 0.38409697870540666, 0.38683160162983327, 0.3880572280490859, 0.3894633366060179, 0.3897408042902272, 0.3914712436948657, 0.3923528418588732, 0.3928288104713827, 0.3947572735454433, 0.3965001396890249, 0.3967171314454053, 0.3962867385832246, 0.39648003135624754, 0.39612611611447035, 0.3964092495497423, 0.39625378048122556, 0.3963429192008103, 0.3959264468123685]
GIMMEAbilitySTDev = [0.023233877467273786, 0.02822858133161458, 0.028424589189562182, 0.028480669648600316, 0.028905417128825352, 0.028266342556348755, 0.028649159002363568, 0.029835261291705203, 0.028649781475419862, 0.02852417979221509, 0.027832833988708356, 0.028761384739022056, 0.028581773418703688, 0.028278423857526006, 0.02884080723891862, 0.028929888053266788, 0.02915532974848279, 0.029120963375531064, 0.02918530238256982, 0.02870558710922797, 0.024148282885085904, 0.02802344669629098, 0.028992925544448694, 0.028384219012657724, 0.0293008282432982, 0.029399395201436793, 0.030112000899700044, 0.030161208757022526, 0.029175978560263646, 0.029118772712038343, 0.029669572018902912, 0.028868520050458035, 0.028765318496601543, 0.028933375331402604, 0.029774714555433224, 0.029299049361024586, 0.029380313859995927, 0.029600420221799338, 0.028921106150470135, 0.028822564594962987]
GIMMEEngagementMeans = [0.5503819836249878, 0.6656389463330521, 0.6926213137389472, 0.7016232321307802, 0.7065194314715345, 0.7097830534755281, 0.7099518821859895, 0.7143391758415252, 0.7196646705058025, 0.7250579963504699, 0.7273656755359951, 0.7282736349602991, 0.7288607473139852, 0.7275573702254488, 0.7302143644865208, 0.729080200034017, 0.7299449759257838, 0.7283271459529288, 0.7287390896161672, 0.7293282289616656, 0.6103794313943911, 0.734698734133571, 0.7626766622702892, 0.7686010236472667, 0.7708493387396791, 0.7730050902152915, 0.7737250692553496, 0.7767834496594639, 0.7789397596502536, 0.7801892387565509, 0.7836958424744553, 0.7869290748512984, 0.787501899860591, 0.7865939590916509, 0.7868530960438938, 0.7861187969670832, 0.7866942304668001, 0.7868662044436863, 0.7867200903903465, 0.7854573968128298]
GIMMEEngagementSTDev = [0.024447806781589126, 0.025873615017365834, 0.027898395330118942, 0.02599843091347407, 0.025015114469786635, 0.023997792839684916, 0.025846082340043618, 0.026736686446664923, 0.02499350255334466, 0.024418162529240433, 0.021042852830779283, 0.02262956884688599, 0.022342634188287806, 0.022204485188976126, 0.021195995366789087, 0.02247698720623695, 0.021951314859777714, 0.02325257423164777, 0.022592473714927053, 0.022524382796177966, 0.02187434042151838, 0.02024688372580222, 0.02189431269528179, 0.022482123534999027, 0.02234385224077099, 0.022515860153346744, 0.02109112023577643, 0.022239044717842313, 0.02208807304987008, 0.020359582242433765, 0.019659897686360263, 0.019557949194153112, 0.01935205049293213, 0.01903919179889541, 0.018872284686090236, 0.020043778457183088, 0.019402593924705225, 0.019422745282184004, 0.018248093498301865, 0.01877544727339213]
GIMMEProfDiffMeans = [0.44126648021276454, 0.4321084468702381, 0.4251593994122171, 0.4187858130484225, 0.41331313242797785, 0.40927487718028854, 0.41013029199035056, 0.40243426921614855, 0.3945711782878826, 0.3869198817882439, 0.384747271424978, 0.38395809856050317, 0.383241232876963, 0.3857528753846367, 0.3805951153468182, 0.38353944311497207, 0.3816097331841124, 0.3847754239942809, 0.38347521432761833, 0.38257939734082397, 0.33520497478368794, 0.3312391373034245, 0.32573419153049715, 0.32515299262535585, 0.32327307355706414, 0.3202571067637138, 0.31974652485334765, 0.3145945720761256, 0.3118640192956531, 0.31041760213153263, 0.30466050153637914, 0.3001846718232683, 0.3003151709714154, 0.3021227228822511, 0.3013436236044684, 0.3027333119941406, 0.3014564657413941, 0.3013559022931721, 0.3016749998706502, 0.3038554887297362]
GIMMEProfDiffSTDev = [0.04321802490100848, 0.04255018713715994, 0.044962989011585956, 0.0410427215149286, 0.04005682665200548, 0.038354578302244736, 0.04095698144831006, 0.04241216848345821, 0.039324886261175855, 0.0381231821876202, 0.032104362842817744, 0.035792801992589135, 0.03482839528596643, 0.03396960215344246, 0.032643411539904715, 0.03554749767346182, 0.03375859587660654, 0.03636404928109551, 0.03463036152313238, 0.03465960966984218, 0.03866873611509995, 0.034939906405445864, 0.03688581993121396, 0.03662124696027411, 0.036296720062277764, 0.03684114275044, 0.03450035408808989, 0.03652052178533654, 0.036039730790516325, 0.03321487800442235, 0.0318922548574032, 0.03141923301699784, 0.031337134566028886, 0.030886409706490474, 0.030295382891425464, 0.03239902018120343, 0.031181140391881138, 0.030962818163592927, 0.029893958965662507, 0.03066307141303379]

GIMMEOldAbilityMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.29623245296951, 0.3610325168989303, 0.3746122902312078, 0.379496554868998, 0.38145183335860305, 0.3825298268613126, 0.3846220033454874, 0.3852643762877196, 0.38787211328207344, 0.3899216785435304, 0.39130844433349676, 0.3918883116391506, 0.39135716022851713, 0.39172715410373293, 0.39205409242474976, 0.39190712329853655, 0.3924485223852076, 0.39212676747305036, 0.392134337228605, 0.3931100122149698]
GIMMEOldAbilitySTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.02388601261549183, 0.028945420867378186, 0.02974036115359839, 0.02960902688880485, 0.029258305461624844, 0.029022739003072423, 0.029258385433572755, 0.02902112345189164, 0.02924660539893451, 0.029162687134190568, 0.028549658742719388, 0.029040313630660994, 0.028808231230520582, 0.029093222626397696, 0.02858493813619273, 0.028740392575918677, 0.029398461136658883, 0.028588743860711776, 0.028715680608155294, 0.029784794462273247]
GIMMEOldEngagementMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5930483968684577, 0.7228716570372956, 0.7499213584361946, 0.7593209686501187, 0.763225182253601, 0.7653166207566109, 0.769594798172061, 0.7706971774156779, 0.77595974069006, 0.7801775054390503, 0.7822945517588834, 0.7836125867659152, 0.7829118760197213, 0.7839785284327601, 0.7841757753384012, 0.7833993973610993, 0.7848476595081086, 0.7840524513356129, 0.7845191811708532, 0.7860477354986559]
GIMMEOldEngagementSTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.023172572343129534, 0.025013753537979667, 0.023177710006916867, 0.025055495590352906, 0.02210148812770869, 0.0235976536603169, 0.02230481136616883, 0.021289724159580373, 0.02058373979223837, 0.02103498722970951, 0.0200425635814147, 0.019327769986905094, 0.018521782808303418, 0.01866616539444068, 0.020831467036875058, 0.01980720210218187, 0.020139637376608288, 0.01989167822253314, 0.019596490355368538, 0.01953668195108921]
GIMMEOldProfDiffMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.36584220487935265, 0.3460192073252742, 0.34410109291525753, 0.3370482862524336, 0.333469810528264, 0.33115298261559345, 0.32432959713558884, 0.3238934116698815, 0.3149801761448321, 0.30938474809505023, 0.3071335086006807, 0.30555201877681737, 0.3072567078231836, 0.305123376276971, 0.3051518082928183, 0.30659400093637484, 0.3037593199074043, 0.305677100628013, 0.30457088250369996, 0.3020337685929354]
GIMMEOldProfDiffSTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.04096370760341602, 0.04330756631656927, 0.03862814814441312, 0.04203444740144883, 0.03622981947161655, 0.03933006133347405, 0.036612154450686635, 0.03462365341907195, 0.03354075418938499, 0.03404024592963272, 0.032503569664109534, 0.03134353738757214, 0.03019438855844292, 0.03090113473101346, 0.0342496198110307, 0.031779833947491926, 0.032635228953507886, 0.032393137212786964, 0.031802602088936004, 0.03137959505465563]

optimalAbilityMeans = [0.304608981440512, 0.36553178386643653, 0.37755632611872203, 0.38013518351542575, 0.38065641423768976, 0.3807897837922344, 0.38065678712207734, 0.3807727995449085, 0.3808107885460144, 0.3808228574924559, 0.38075133977363873, 0.38079764777195474, 0.3805701065438309, 0.38078044370653447, 0.3807091481783585, 0.3807827468675298, 0.3806962869615429, 0.3807960061111983, 0.38084584677699634, 0.38057066519990485, 0.32203423684170657, 0.38637650568219595, 0.399217105077989, 0.4018718951644782, 0.4024250766776155, 0.4024844109801471, 0.4024699966554735, 0.40263192623630506, 0.40261207495927065, 0.402520295109223, 0.40254007260229363, 0.4024568254689321, 0.40260609574797046, 0.4025708298123816, 0.4024977446040781, 0.4023287465524641, 0.402511932432449, 0.4025056760811743, 0.40257536840053, 0.4025225602556265]
optimalAbilitySTDev = [0.020906215857945113, 0.024945499553978737, 0.025896878686728738, 0.025847620021785124, 0.025837784490050964, 0.025938435328812834, 0.0260051065674879, 0.025983550986544375, 0.025972047243150706, 0.02584609986551581, 0.025832742824595682, 0.02604158910526461, 0.025855211097432485, 0.0259156367378922, 0.026006576174371538, 0.025854997862986267, 0.0257315212690177, 0.02607623686751637, 0.026019752511048155, 0.025937202705891355, 0.02187076631900886, 0.026241633931336352, 0.027065222048618442, 0.027214179757862157, 0.027228532026923002, 0.027327997214078276, 0.02738253761751362, 0.02735438575799757, 0.02734172462163079, 0.02740217571468028, 0.027303152129529985, 0.027224609604110016, 0.027284176360509175, 0.0272693374793177, 0.027339419431115022, 0.02737334209018009, 0.027307883163055158, 0.027219889972311576, 0.02730072859509077, 0.027371008062407245]
optimalEngagementMeans = [0.6092564677854321, 0.7310765382337672, 0.7549431904650775, 0.7599812052004046, 0.7610430029250701, 0.7614865381083813, 0.7611284748198532, 0.7614712118124606, 0.7613948581504314, 0.7612962233739783, 0.7614672897722056, 0.7614465181176648, 0.7612239973086833, 0.7615761223073866, 0.7614122959979328, 0.7615540683756611, 0.7615385587750453, 0.761657758210068, 0.7616112213942098, 0.7611801607358932, 0.6448818631172787, 0.7736824949792281, 0.7994628393738032, 0.804802151335665, 0.8058452627336943, 0.8058619283093552, 0.8059389448205905, 0.8062488279783264, 0.8061315792483869, 0.8059761766157517, 0.8059721039233306, 0.805843100244255, 0.8060809557202485, 0.8061546259130928, 0.8059855894508904, 0.8055497435298044, 0.8059095958254316, 0.8058788244710581, 0.8061733947221231, 0.8060112336809643]
optimalEngagementSTDev = [0.012316217446315492, 0.014602593203946076, 0.015283160412072144, 0.015207341812578915, 0.015450866114560072, 0.01503261243768995, 0.015346230668430992, 0.01522640799600787, 0.015242237778098721, 0.015375455637761846, 0.01518046368419003, 0.01567220926245135, 0.015544502662063165, 0.015320993198035716, 0.015090706416183363, 0.015179712777763532, 0.015447849461120308, 0.015369111921145791, 0.015185102963169645, 0.01544984867674464, 0.008315956474780693, 0.010070131307539604, 0.010182354399251924, 0.010274914027793626, 0.010202968830953327, 0.010480542363966531, 0.01047073908850621, 0.010288145793688102, 0.010394348338297988, 0.010787293443670224, 0.010599734206323486, 0.010408056314293888, 0.010223556398310749, 0.009976058086927824, 0.010406003675218491, 0.010318700377317703, 0.010116864046160988, 0.010298517188943474, 0.010423454605909216, 0.010294372148244486]
optimalProfDiffMeans = [0.3371901127409892, 0.33724530792080853, 0.33812452777767726, 0.3376566276384983, 0.3375608239016346, 0.3371521592477786, 0.33794194506421643, 0.33720947144542057, 0.3374656227517104, 0.3376129909538436, 0.3372757127686485, 0.3373729133182136, 0.3377589343617879, 0.3370577864392748, 0.337471888162356, 0.3371633462909888, 0.33724088775524985, 0.3370246874613205, 0.33714909707090046, 0.3378946586083623, 0.27421271618698967, 0.2745233848974682, 0.2744876441459959, 0.27416371307960097, 0.27420746706945504, 0.2745468017870885, 0.2744165467144751, 0.2738959749576282, 0.27421280362879913, 0.2744460655811617, 0.2743983220245582, 0.2746249305510248, 0.27415884781284466, 0.2741127106905246, 0.2744375741087178, 0.2751482847102537, 0.2743580549109179, 0.27453967849351024, 0.2740080676216776, 0.2743988768623292]
optimalProfDiffSTDev = [0.021772202187125982, 0.02182845543244934, 0.022258830551376455, 0.021836395022961495, 0.02231294891200413, 0.021575377692415725, 0.022222233287099147, 0.02188485900695691, 0.02206302099299185, 0.022181120701852908, 0.02176539757660975, 0.022714007986951997, 0.022353888287793916, 0.021986165181824575, 0.02166485939563427, 0.021913326489243497, 0.022330184984818258, 0.022118766459260458, 0.021860117589968316, 0.022383275901236094, 0.014700673038493869, 0.015110410264403617, 0.014684361191271502, 0.014813626230233402, 0.014634988197284452, 0.015164733431457456, 0.015067088178315634, 0.014770863911944787, 0.015011521482050205, 0.015619410048992694, 0.01515117389246964, 0.014894561309361098, 0.014602842073196691, 0.014239593547542822, 0.01510171041761667, 0.014753335623509048, 0.014466140602864223, 0.014883408919754494, 0.015027367790845026, 0.014773851718428955]

randomAbilityMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2975820971324721, 0.3567456276494789, 0.368423908703727, 0.3712635719177365, 0.3736437732137183, 0.3723133809558987, 0.37196273990399303, 0.3727999355216633, 0.3721282628381166, 0.3721897916638535, 0.372753028382533, 0.3728262652008798, 0.37224598369894896, 0.37194676509878394, 0.37216510405389286, 0.37235399212652154, 0.3719838491727063, 0.3720111655135554, 0.3717523486646923, 0.3713274273694614]
randomAbilitySTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.023713635056667126, 0.028849125540785746, 0.028385178575785087, 0.027906356833428902, 0.02870533317391534, 0.027547748817858486, 0.02765820139747749, 0.028813856934049982, 0.026627208206268613, 0.026613904254489746, 0.02720754719796109, 0.028489883807819114, 0.02842089844718397, 0.02785465711512495, 0.027876610830010803, 0.027416471625363665, 0.028492739256035647, 0.02744898888348626, 0.02808175935935893, 0.027779090867812245]
randomEngagementMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5931437956057032, 0.7106571564720258, 0.7344489892713887, 0.7396261583786891, 0.7441921886370655, 0.7420594934241854, 0.7411966646357928, 0.7425441914695277, 0.7416848509524576, 0.7418470358847422, 0.7424439612092566, 0.7426424342078133, 0.7413503101529113, 0.7413660560510548, 0.7414405737302706, 0.742211287498556, 0.7415700800644768, 0.7413974410127123, 0.7405445638777949, 0.7397383074590143]
randomEngagementSTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.025620244389101425, 0.026360837196190333, 0.026055234164789626, 0.02622452120092747, 0.025740704471197112, 0.025289210134890182, 0.024868929231551446, 0.025808825845263353, 0.024397917120897988, 0.02601722110384375, 0.025101595942788782, 0.025051581267066705, 0.02592538136572094, 0.02482372159454651, 0.024346720992830938, 0.02431322558060991, 0.025368924845457583, 0.024345278995906702, 0.024515507773138753, 0.025632841457572098]
randomProfDiffMeans = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3656735621442939, 0.3676453263185587, 0.3671341577196421, 0.36639381241648206, 0.36015254071103947, 0.3655369843085191, 0.3663082429030924, 0.36362107345454303, 0.3656166099029468, 0.3650260819859006, 0.364028198156547, 0.36388838912105526, 0.36624273412602454, 0.3657580642069652, 0.36563190133191165, 0.3642958049802872, 0.3657017987582018, 0.36578028330631046, 0.3672269341982581, 0.3683506700481873]
randomProfDiffSTDev = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.045290621357958624, 0.044234668707064884, 0.043849825933787626, 0.04422545241914807, 0.0422166495312319, 0.04217005242947033, 0.041445165430510855, 0.04288610929431376, 0.04040599004486622, 0.04312947169353307, 0.04131997449005478, 0.04179378125247666, 0.042784870622145726, 0.04107387038571766, 0.04093959997503381, 0.04065586057688507, 0.042945053053442726, 0.04066647653653076, 0.041977846257709374, 0.04377401211346835]

# ----------------------- [Generate Plots] --------------------------------
# sns.set()
sns.set_palette(sns.color_palette("colorblind"))

timesteps=[i+1 for i in range(maxNumTrainingIterations + numRealIterations)]
timestepsReal=[i+1 for i in range(numRealIterations)]
convValue=[1.0 for i in range(maxNumTrainingIterations + numRealIterations)]
empHighestValue=[max(optimalAbilityMeans) for i in range(maxNumTrainingIterations + numRealIterations)]
totalMin = min(min(randomAbilityMeans[maxNumTrainingIterations:]),min(GIMMEAbilityMeans),min(GIMMEOldAbilityMeans[maxNumTrainingIterations:]),min(optimalAbilityMeans[maxNumTrainingIterations:]))
totalMax = max(max(randomAbilityMeans[maxNumTrainingIterations:]),max(GIMMEAbilityMeans),max(GIMMEOldAbilityMeans[maxNumTrainingIterations:]),max(optimalAbilityMeans[maxNumTrainingIterations:]))

plt.rcParams.update({'font.size': 22})

fig = plt.figure(num=None, figsize=(20, 10), dpi=100, facecolor='w', edgecolor='k')
ax = fig.add_subplot(111)
c1 = collections.BrokenBarHCollection([(0,maxNumTrainingIterations)], (totalMin,(totalMax-totalMin)), facecolor="white", alpha=0.5)
# c2 = collections.BrokenBarHCollection([(maxNumTrainingIterations,numRealIterations)], (totalMin-0.05,(totalMax-totalMin)+0.1), facecolor='#bdedcf', alpha=0.5)
ax.add_collection(c1)
# ax.add_collection(c2)
plt.xticks(np.arange(1, numRealIterations+1, step=1.0), fontsize=30)
plt.yticks(fontsize=30)


plt.errorbar(timestepsReal, GIMMEAbilityMeans[maxNumTrainingIterations:], GIMMEAbilitySTDev[maxNumTrainingIterations:], marker='s', capsize=5.0, alpha=0.5, linewidth=3, elinewidth=2, label="GIMME strategy (with training)")
plt.errorbar(timestepsReal, GIMMEOldAbilityMeans[maxNumTrainingIterations:], GIMMEOldAbilitySTDev[maxNumTrainingIterations:], marker='s', capsize=5.0, alpha=0.5, linewidth=3, elinewidth=2, label="GIMME strategy (no training)")
# plt.errorbar(timesteps, GIMMEGridAbilityMean, GIMMEGridAbilitySTDev, marker='s', capsize=2.0, alpha=0.5, label="GIMME Grid strategy")
# plt.plot(timesteps, GIMMEEvAbilities, label="GIMME Ev strategy")
plt.errorbar(timestepsReal, randomAbilityMeans[maxNumTrainingIterations:], randomAbilitySTDev[maxNumTrainingIterations:], marker='s', capsize=5.0, alpha=0.5, linewidth=3, elinewidth=2, label="Random strategy")
# plt.errorbar(timesteps, optimalAbilityMeans, optimalAbilitySTDev, marker='s', capsize=2.0, alpha=0.5, label="\"Perfect Information\" strategy")
plt.plot(timestepsReal, empHighestValue[maxNumTrainingIterations:], linestyle= "--", linewidth=3, label="Highest avg. \"Perfect Information\" increase")
plt.xlabel("Iteration", fontsize=40)
plt.ylabel("avg. Ability Increase", fontsize=40)
plt.legend(loc='best', fontsize=29)

plt.savefig('./plotsOnlyOutput/simulationsResultsAbility.png')
plt.show()
